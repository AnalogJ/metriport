---
title: "Webhooks"
description: "Receive status updates as soon as data becomes available after initiating a document query."
---

## Overview

When using the Medical API, Metriport will send Webhook messages containing [patient document data](#patient-data-message) to your app, as soon
as the data becomes available after initiating a [document query](/medical-api/api-reference/document/start-document-query).

You can expect to receive updates in the following scenarios:

1. When queried documents have completed downloading (`type` for a patient in the message will be `document-download`, and at this point you'll be able to [download the raw files](/medical-api/api-reference/document/get-document));
1. Then, if the downloaded documents contained C-CDA/XML files, when the conversion to FHIR has completed (`type` for a patient in the message will be `document-conversion`, and at this point you'll be able to [query for FHIR resrouces](/medical-api/api-reference/fhir/get-patient-consolidated)).

To enable this integration approach with Metriport, and for some prerequesite reading to understand
how the Webhook flow works, see [our Webhooks guide](/home/api-info/webhooks).

### Patient data message

Example payload:

```json
{
  "meta": {
    "messageId": "<message-id>",
    "when": "<date-time-in-utc>",
    "type": "medical"
  },
  "patients": [
    {
      "patientId": "<patient-id-1>",
      "type": "document-conversion",
      "status": "completed",
      "documents": [
        {
          "id": "1.2.543.1.34.1.34.134",
          "fileName": "CCDA_Diag.xml",
          "location": "https://fhir.metriport.com/oauth/fhir/Binary/2.16.840.1.113883.3.777.666.5.700009.969696",
          "description": "Patient Diagnoses",
          "status": "current",
          "indexed": "2019-09-07T15:50:00.000Z",
          "mimeType": "application/xml",
          "size": "17344007",
          "type": {
            "coding": [
              {
                "system": "http://snomed.info/sct",
                "code": "62479008",
                "display": "Diagnoses"
              }
            ],
            "text": "Diagnoses"
          }
        },
        {
          "id": "1.2.543.1.224.54.22.540",
          "fileName": "Progress_Notes.xml",
          "location": "https://fhir.metriport.com/oauth/fhir/Binary/2.16.840.1.113883.3.777.666.5.700009.69696969",
          "description": "Patient Encounter Progress Notes 2023-03-22",
          "status": "current",
          "indexed": "2023-03-22T08:34:00.000Z",
          "mimeType": "application/xml",
          "size": "8675545",
          "type": {
            "coding": [
              {
                "system": "http://snomed.info/sct",
                "code": "371532007",
                "display": "Progress Report"
              }
            ],
            "text": "Progress Notes"
          }
        },

      ]
    },
    {
      "patientId": "<patient-id-2>",
      "type": "document-conversion",
      "status": "completed",
      ...
    }
  ]
}
```

The format follows:

<ResponseField name="meta" required>
  Metadata about the message. The full format is described [here](/home/api-info/webhooks#meta-data).

  <Expandable title="meta type property details">

    <ResponseField name="type" type="MAPIWebhookType" required>
      The type of the Medical API webhook data message. Can be one of: `medical.document-download`, `medical.document-conversion`.
    </ResponseField>

  </Expandable>

</ResponseField>

<ResponseField name="patients" type="PatientDocQueryUpdate[]" required>
  Array of Document query status updates - where each item corresponds to a specific patient.
  
  <Expandable title="PatientDocQueryUpdate properties">

    <ResponseField name="patiendId" type="string" required>
      The Patient ID.
    </ResponseField>

    <ResponseField name="type" type="string" required>
      Specifies what step in the Document query flow this message is for - can be one of
      `document-download` | `document-conversion`.
    </ResponseField>

    <ResponseField name="status" type="string" required>
      The outcome of the step corresponding to `type` - can be one of `completed` | `failed`.
    </ResponseField>

    <ResponseField name="documents" type="DocumentReference[]">
      An array of objects describing the Documents that can be retrieved for the Patient - will only be present for `document-download` messages.
      <Expandable title="DocumentReference properties">
        <Snippet file="document-reference-response.mdx" />
      </Expandable>
    </ResponseField>

  </Expandable>
</ResponseField>
