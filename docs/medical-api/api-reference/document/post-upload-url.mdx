---
title: "Post Upload URL"
description: "Returns a presigned URL to use for a medical document upload to our servers."
api: "POST /medical/v1/document/upload-url"
---

To use this endpoint, you will need to create a prelimiary version of a [DocumentReference](/medical-api/fhir/resources/documentreference), which we will use as a draft before the file can be uploaded to our servers. In this DocumentReference, we made it a mandatory practice to include the `type` field where you can specify the kind of document ([LOINC](https://www.hl7.org/fhir/valueset-doc-typecodes.html), if possible),`description` field to outline a very brief description of the document, and `context` to provide the relevant dates. Besides these mandatory fields, we ask that you try to provide as much context to the file as possible, including the practitioner (`author` field in the DocumentReference) and narrative (`text`). Note that you **do not** need to enter any references to the patient or your organization, as those will be inferred on our end - anything you will enter in these fields will be overwritten. Once your DocumentReference draft meets the minimum criteria, you can execute the endpoint and receive a presigned URL to use for consecutive file upload. Use that URL with a form-based upload, mapping the URL attributes `url` and `fields` to the corresponding fields of the form. Append the file stream and upload the file. See example below for reference.

Once the file is uploaded, the DocumentReference will be updated with the file attachment details on our end and uploaded it to our FHIR servers, making it available to other HIEs.

## Query Params

<ParamField query="patientId" type="string" required>
  The ID of the Patient.
</ParamField>

## Body

    <ParamField body="type" type="CodeableConcept" required>
      A [CodeableConcept](/medical-api/fhir/data-types/codeableconcept) of the file type.
      <Expandable title="Type properties">
        <ParamField body="text" type="string" required>
          Plain text representation of the document kind.
        </ParamField>

        <ParamField body="coding" type="Coding">
          A [Coding](/medical-api/fhir/data-types/coding) property, which is a reference to a code defined by a terminology system.
        </ParamField>
      </Expandable>
    </ParamField>

    <ParamField body="description" type="string" required>
      A brief description of the file.
    </ParamField>

    <ParamField body="context" type="DocumentReferenceContext[]" required>
      Context of the document content.
      <Expandable title="Context properties">
        <ParamField body="period" type="Period" required>
          A time [Period](/medical-api/fhir/data-types/period) property defined by a start and end date and optionally time.
        </ParamField>

        <ParamField body="facilityType" type="CodeableConcept">
          Optional [CodeableConcept](/medical-api/fhir/data-types/codeableconcept) for the facilityType. We ask that you provide the name of the facility that generated the document under `text`.
            <Expandable title="Facility type properties">
          <ParamField body="type" type="CodeableConcept" required>
            A [CodeableConcept](/medical-api/fhir/data-types/codeableconcept) for the type and name of the facility.
              <ParamField body="text" type="string">
                Plain text with the facility name and type.
              </ParamField>

              <ParamField body="coding" type="Coding">
                A [Coding](/medical-api/fhir/data-types/coding) property, which is a reference to a code defined by a terminology system.
              </ParamField>
          </ParamField>
            </Expandable>
        </ParamField>

      </Expandable>
    </ParamField>

## Response

A presigned URL that can be used to upload a medical document to our system.

```json
{
  "url": "https://s3.us-east-2.amazonaws.com/metriport-medical-document-uploads-staging",
  "fields": {
    "key": "<s3-object-key>",
    "bucket": "<s3-bucket-name>",
    "X-Amz-Algorithm": "AWS4-HMAC-SHA256",
    "X-Amz-Credential": "<some-credentials-string>",
    "X-Amz-Date": "20231020T064041Z",
    "Policy": "<some-policy-string>",
    "X-Amz-Signature": "<some-signature-string>"
  }
}
```

<ResponseExample>

```javascript Metriport SDK
import { MetriportMedicalApi } from "@metriport/api-sdk";
import FormData from "form-data";

const metriportClient = new MetriportMedicalApi("YOUR_API_KEY");
const docRefDraft = {
  description: "Third degree wrist burn treatment",
  type: {
    text: "Burn management Hospital Progress note",
    coding: {
      code: "100556-0",
      system: "http://loinc.org",
    },
  },
  context: {
    period: {
      start: "2023-10-10T14:14:17Z",
    },
    facilityType: {
      text: "My Clinic Name - Acute Care",
    },
  },
};

const presignedUrl = await metriportClient.getDocumentUploadUrl("my-patient-id", docRef);

const form = new FormData();
Object.entries(presignedUrl.fields).forEach(([field, value]) => {
  form.append(field, value);
});
const contentType = "application/pdf";
form.append("Content-Type", contentType);
form.append("file", createReadStream("<my-file-path>"));

form.submit(presignedUrl.url, (err, response) => {
  if (err) {
    console.log(`ERROR: `, err);
    return;
  }
  console.log(`RESPONSE: `, response.statusCode);
});
```

</ResponseExample>
