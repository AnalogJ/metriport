---
title: "Apple Health"
description: "Our iOS SDK allows you to receive Apple Health data via webhooks."
---

## Overview

This is a guide to help you get started with iOS, specifically Apple Health. First and foremost Apple Health is a central repository for health and fitness data only available on iPhone.
Where Metriport comes in is we provide an SDK that allows you to be able to receive Apple Health data in the background.
When data gets added to Apple Health by a user it will simply send that data to the Metriport api and from there it gets sent to your webhook URL.

<Info>
  Apple Health is available for devices on iOS v13 or higher. This also applies
  for when developing on a simulator.
</Info>

<Tip>
  As a prerequisite we suggest looking at our [webhooks
  docs](/more-info/webhooks) to understand how the flow works.
</Tip>

## Initial Setup

### 1. Enable HealthKit

First thing you need to do is enable HealthKit capabilities for your app.
In Xcode, select the project, click on the `Signing & Capabilities` tab and add the HealthKit capability.
Make sure to select `Background Delivery` under `Capabilities` to be able to receive data via webhooks.

<img className="h-100" src="/images/healthkit-capability.png" />

Also add the following key in your Info.plist:

```swift
<key>NSHealthShareUsageDescription</key>
<string>Example: Share usage with all people</string>
```

### 2. Install Metriport iOS SDK Package

Our packages can be downloaded using SPM (Swift Package Manager).
To add a package dependency to your Xcode project, select `File > Add Packages` and enter our repo URL:

```
https://github.com/metriport/metriport-ios-sdk.
```

<img className="h-100" src="/images/package-install.png" />

## Usage

To use our SDK go to the root of your project and add:

```swift
import MetriportSDK

var healthStore = MetriportHealthStoreManager(clientApiKey: "CLIENT_API_KEY", apiUrl: "ENVIRONMENT_URL");
```

<Warning>
  Ensure you use your Client Key here, and not your Secret Key. You can read
  more about the differences between the two in our [API Keys
  guide](/more-info/api-keys).
</Warning>

<Info>
  ENVIRONMENT_URL is optional and defaults to https://api.metriport.com. For
  sandbox mode add https://api.sandbox.metriport.com.
</Info>

The next step is to add the `MetriportWidget` inside of a view to be able to access all available providers.

```swift
var body: some View {
    VStack {
        Button {
            webviewController.getToken()
        } label: {
            Text("Metriport Widget")
        }
        .sheet(isPresented: $webviewController.showWebView) {
            MetriportWidget(url: "\(WIDGET_URL)/?token=\("TOKEN")", healthStore: healthStore)
        }
    }
    .padding()
}
```

<Info>Make sure to pass the healthStore to the widget.</Info>

## Receiving Data

The way we receive and send data via webhooks is in 2 steps:

**Step 1:** When the user first connects to Apple Health we will make an initial query for all data within the last 30 days.
This will be a daily average of all data types.

**Step 2:** Once this data is queried we will then listen on an hourly basis for any updates to the Apple Health.
If there are changes then a query will be sent via webhook with just the data that's been added.

<Info>
  To understand the data you should expect to receive from Apple Health checkout
  our [data models](/more-info/models)
</Info>
